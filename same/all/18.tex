\section{О кельтском камне в форме эллипсоида}

Кельтские камни представляют собой тела, тензор инерции которых в осях симметрии системы имеет ненулевые недиагональные компоненты. Простейшим примером кельтского камня будет выступать эллипсоид вращения плотность которого постоянна со вставками двух точечных масс не изменяющих положение центра масс, но тем не менее вносящих вклад в недиагональные компоненты.

Легко убедиться (от 10 минут до получаса, если уметь брать кратные интегралы), что момент инерции однородного эллипсоида вращения с полуосями $a$, $b$, $c$ в системе в которой оси совпадают с осями симметрии системы, 0 в центре симметрии, имеет вид:
\[
	\hat{J} = 
	\begin{pmatrix}
	\frac{1}{5}m(b^2 + c^2) & 0 & 0 \\
	0 & \frac{1}{5}m(a^2 + c^2) & 0 \\
	0 & 0 & \frac{1}{5}m(a^2 + b^2) 
	\end{pmatrix}
\]
С массой $M$ добавленной в точки $(x_a, y_a, 0)$,  $(-x_a, -y_a, 0)$ мы получим следующий тензор инерции:
\[
	\hat{J} = 
	\begin{pmatrix}
	\frac{1}{5}m(b^2 + c^2) + M y_a^2 & M x_a y_a & 0 \\
	M x_a y_a & \frac{1}{5}m(a^2 + c^2) + M x_a^2 & 0 \\
	0 & 0 & \frac{1}{5}m(a^2 + b^2) 
	\end{pmatrix}
\]
В общем случае тензор инерции будет иметь вид:
\[
	\hat{J} = 
	\begin{pmatrix}
	J_{xx} & J_{xy} & J_{xz} \\
	J_{yx} & J_{yy} & J_{yz} \\
	J_{zx} & J_{zy} & J_{zz} 
	\end{pmatrix}
\]
Тело при этом пусть будет эллиптической формы, центр масс на оси симметрии системы. Тело лежит на подложке, которая действует на него моментом сил трения $\vec{M}_{fr}$ в направлении перпендикулярном подложке и противоположно компоненте угловой скорости в данном направлении. Неподвижные оси $x', y', z'$ направим как показано на рисунке. Подвижные оси будут представлять собой оси симметрии эллипсоида $x, y, z$. В подвижной системе жёстко связанной с телом на систему будут действовать силы трения (будем считать, что они приводят только к наличию момента $\vec{M}_{fr}$ в направлении перпендикулярном подложке и противоположно проекции угловой скорости на данное направление), сила реакции опоры, направленная перпендикулярно подложке $\vec{N}$, сила инерции, так как центр масс движется вообще говоря ускоренно (но она постоянна по величине и не создаёт относительно центра масс момента, в чём также легко убедиться с помощью интегрирования), центробежная сила (приводит к знаменитым эйлеровым уравнениям -- момент равен $-\vec{\omega}\times\vec{L}$), а вот сила Кориолиса равна 0, так как скорость движения точек тела в подвижной системе координат связанной с телом равна 0. Уравнения динамики вращательного движения:
\[
	\hat{J} \frac{d\vec{\omega}}{dt} + \vec{\omega}\times(\hat{J}\vec{\omega}) = \vec{N}\times\vec{R} + \vec{M}_{fr}
\]
Введём эйлеровы углы $(\psi, \theta, \phi)$. Для полного счастья нам понадобятся орты подвижной системы координат, выраженные через неподвижные. С помощью вспомогательного единичного вектора $\vec{n}$, получим:
\[
	\begin{aligned}
	& \vec{n} = \cos \psi \vec{e}_x + \sin \psi \vec{e}_y \\
	& \vec{e}'_z = \vec{e}_z \cos \theta  + \vec{n}\times\vec{e}_z \sin \theta \\
	& \vec{e}'_x = \vec{n} \cos \phi  + \vec{e}_z\times\vec{n} \sin \phi \\
	& \vec{e}'_y = \vec{e}'_z \times \vec{e}'_x = - \vec{n} \sin \phi + \vec{e}_z\times\vec{n} \cos \phi
	\end{aligned}
\]
Или в страшной форме, после долгих и утомительных преобразований:
\[
	\begin{aligned}
	& \vec{e}_x =
	[\cos \phi \cos \psi - \sin \phi \sin \psi \cos \theta] \vec{e}'_x +
	[\cos \phi \sin \psi + \sin \phi \cos \psi \cos \theta] \vec{e}'_y +
	\sin \theta \sin \phi \vec{e}_z \\
	& \vec{e}_y =
	[- \sin \phi \cos \psi - \cos \phi \sin \psi \cos \theta] \vec{e}'_x +
	[- \sin \phi \sin \psi + \cos \phi \cos \psi \cos \theta] \vec{e}'_y +
	\sin \theta \cos \phi \vec{e}_z \\
	& \vec{e}_z =
	\sin \psi \sin \theta \vec{e}'_x -
	\sin \theta \cos \psi \vec{e}'_y +
	\cos \theta \vec{e}_z \\
	\end{aligned}
\]
Отсюда просто найти и обратное преобразование, но нам потребуется всего один вектор:
\[
	\vec{e}'_z =
	\sin \theta \sin \phi \vec{e}_x -
	\sin \theta \cos \phi \vec{e}_y +
	\cos \theta \vec{e}_z
\]
Зачем он нужен? Во-первых вдоль него направлен момент сил трения, а во-вторых с его помощью можно найти нормаль к эллипсоиду, который повернули на произвольные эйлеровы углы в точке соприкосновения с подложкой и как следствие найти эту точку.
Нормаль в точке эллипсоида $(x_a, y_a, z_a)$ (ещё 10-30 минут утомительных вычислений) коллинеарна вектору:
\[
	\left\{
		\frac{x_a}{a^2},  \frac{y_a}{b^2}, \frac{z_a}{c^2}
	\right\}
\]
Поэтому:
\[
	\begin{aligned}
	& A\sin \theta \sin \phi  = \frac{x_a}{a^2} \\
	& -A\sin \theta \cos \phi  = \frac{y_a}{b^2} \\
	& A\cos \theta  = \frac{z_a}{c^2} \\
	\end{aligned}
\]
Подставляем в уравнение эллипса:
\[
	A^2[a^2\sin^2 \theta \sin^2 \phi + b^2\sin^2 \theta \cos^2 \phi + c^2\cos^2 \theta] = 1
\]
\[
	A = \pm \frac{1}{\sqrt{a^2\sin^2 \theta \sin^2 \phi + b^2\sin^2 \theta \cos^2 \phi + c^2\cos^2 \theta}}
\]
Знак на самом деле вполне определён, но в данный момент мне придётся долго вспоминать чему он равен. Так, так, так... Кажется $z_a$ по картинке у нас отрицательное, значит и знак отрицательный. Теперь можно чётко записать, что такое $\vec{R}$:
\[
	\vec{R} = x_a \vec{e}_x + y_a \vec{e}_y + z_a \vec{e}_z
\]
Тем самым динамические уравнения полностью определены. Кинематические уравнения я подсмотрел в одном из курсов теоретической механики:
\[
	\begin{aligned}
	& \omega_x = \dot{\psi} \sin \theta \sin \phi + \dot{\theta} \cos \phi \\
	& \omega_y = \dot{\psi} \sin \theta \cos \phi - \dot{\theta} \sin \phi \\
	& \omega_z = \dot{\psi} \cos \theta + \dot{\phi}
	\end{aligned}
\]
В таком виде для нас они бесполезны, однако вполне сойдут в виде:
\[
	\begin{aligned}
	& \dot{\psi} = \frac{\omega_x \sin \phi + \omega_y \cos \phi}{\sin \theta} \\
	& \dot{\theta} = \omega_x \cos \phi - \omega_y \sin \phi \\
	& \dot{\phi} = \omega_z - \frac{\omega_x \sin \phi + \omega_y \cos \phi}{\sin \theta} \cos \theta \\
	\end{aligned}
\]
Начальные условия для системы:
\[
	\omega_x(0) = \omega_y(0) = 0
	\quad
	\omega_z(0) = \Omega 
	\quad
	\theta(0) = \phi(0) = \psi(0) = 0 
\]
Но легко видеть, что этот случай неинтересен и ни к чему особенному приводить не должен. Более интересный случай связан с небольшими отклонениями от 0 в начальных условиях. В принципе осталось разобраться с силой реакции опоры. Из-за ускоренного движения центра масс эллипсоида она может принимать, вообще говоря значения отличные от $mg$, однако если по сравнению с $g$ добавкой можно пренебречь, то осталось перейти к моделированию. Но мне лень.