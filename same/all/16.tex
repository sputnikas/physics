\section{Упругое столкновение релятивистских шаров}

Пусть сталкиваются два релятивистских шара и нормаль $\vec{n}$ в точке столкновения известна, поперечных мгновенных сил нет. Тогда законы сохранения:
\[
	\begin{aligned}
	& p_{1\perp} = p'_{1\perp} \\
	& p_{2\perp} = p'_{2\perp} \\
	& p_{1n} + p_{2n} = p'_{1n} + p'_{2n} = 2 p \\
	& E_1 + E_2 = E_1' + E_2' = E
	\end{aligned} 
\]
Задача сводится к системе:
\[
	\begin{cases}
		x + y = 0; \\
		\sqrt{(x + p)^2 + a^2} + \sqrt{(y + p)^2 + b^2} = d
	\end{cases}
	\text{ где }
	\begin{cases}
	& x = p'_{1n} - p \\
	& y = p'_{2n} - p \\
	& a^2 = p_{1\perp}^2 + m_1^2 c^2 \\
	& b^2 = p_{2\perp}^2 + m_2^2 c^2 \\
	& d = E/c
	\end{cases}
\]
Или к одному уравнению:
\[
	\sqrt{(x + p)^2 + a^2} + \sqrt{(p - x)^2 + b^2} = d
\]
\[
	d^2 = 2(x^2 + p^2) + a^2 + b^2 + 2\sqrt{(x + p)^2 + a^2}\sqrt{(p - x)^2 + b^2}
\]
\[
	(d^2 - a^2 - b^2  - 2(x^2 + p^2))^2 = 4((x + p)^2 + a^2)((p - x)^2 + b^2)
\]
\[
	(d^2 - a^2 - b^2)^2  - 4(x^2 + p^2)(d^2 - a^2 - b^2) + 4 (x^2 + p^2)^2 = 4(p^2 - x^2)^2 + 4 a^2(p - x)^2 + 4 b^2(p + x)^2 + 4 a^2 b^2
\]
\[
	(d^2 - a^2 - b^2)^2  - 4(x^2 + p^2)(d^2 - a^2 - b^2) + 16 x^2 p^2 =  4 (a^2 + b^2)(p^2 + x^2) + 8 px (b^2 - a^2) + 4 a^2 b^2
\]
\[
	(d^2 - a^2 - b^2)^2  - 4(x^2 + p^2)d^2 + 16 x^2 p^2 =  8 px (b^2 - a^2) + 4 a^2 b^2
\]
\[
	4 x^2 (4 p^2 - d^2) - 8 px (b^2 - a^2) + (d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2 = 0
\]
Это обычное квадратное уравнение. Его дискриминант $D$:
\[
	\begin{gathered}
	D/16 = 4 p^2 (b^2 - a^2)^2 - (4 p^2 - d^2) ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = 4 p^2 [(b^2 - a^2)^2 - (d^2 - a^2 - b^2)^2 + 4 p^2 d^2 + 4 a^2 b^2] + d^2 ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = 4 p^2 [(b^2 + a^2)^2 - (d^2 - a^2 - b^2)^2 + 4 p^2 d^2] + d^2 ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = 4 p^2 [4 p^2 d^2 - d^4 + 2 d^2(a^2 + b^2)] + d^2 ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = d^2 [16 p^4 + 8 p^2 (a^2 + b^2) + d^4 - 2 d^2(a^2 + b^2) - 8 p^2 d^2 + (a^2 - b^2)^2] =
	\\ = d^2 [(4p^2 - d^2)^2 + 2(4 p^2 - d^2)(a^2 + b^2) + (a^2 + b^2)^2 - 4 a^2 b^2] =
	\\ = d^2 [(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2]
	\end{gathered}
\]
\[
	x_{1, 2} = \frac{2 p (b^2 - a^2) \pm d\sqrt{(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2}}{2 (4 p^2 - d^2)}
\]
\[
	\begin{gathered}
	4p^2 - d^2 + a^2 + b^2 =
	\\ = (p_{1n} + p_{2n})^2 - \left(\sqrt{p_{1n}^2 + a^2} + \sqrt{p_{2n}^2 + b^2}\right)^2 + a^2 + b^2 =
	\\ = 2 p_{1n} p_{2n} - 2 \sqrt{p_{1n}^2 + a^2} \sqrt{p_{2n}^2 + b^2} = 2 p_{1n} p_{2n} - 2 E_1 E_2/c^2
	\end{gathered}
\]
\[
	\begin{gathered}
	(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2 = 
	\\ = 4 [2 p_{1n}^2 p_{2n}^2 - 2 p_{1n} p_{2n} \sqrt{p_{1n}^2 + a^2} \sqrt{p_{2n}^2 + b^2} + p_{1n}^2 b^2 + p_{2n}^2 a^2] =
	\\ = 4 [ p_{1n}^2 E_2^2 + p_{2n}^2 E_1^2 - 2 p_{1n} p_{2n} E_1 E_2] /c^2 =
	\\ = 4 [ p_{1n} E_2 - p_{2n} E_1]^2/c^2
	\end{gathered}
\]
\[
	b^2 - a^2 = (E_2^2 - E_1^2)/c^2 - p_{2n}^2 + p_{1n}^2
\]
\[
	\begin{gathered}
	c^2(2 p (b^2 - a^2) \pm d\sqrt{(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2}) =
	(p_{1n} + p_{2n}) ( (E_2^2 - E_1^2) - p_{2n}^2 c^2 + p_{1n}^2 c^2) \pm 2 (E_1 + E_2)[ p_{1n} E_2 - p_{2n} E_1] =
	\\ = p_{1n} E_2^2 - p_{1n} E_1^2 + p_{2n} E_2^2 - p_{2n} E_1^2 + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2 \pm
	\\ \pm 2 (p_{1n} - p_{2n}) E_1 E_2 \pm  2 p_{1n} E_2^2 \mp 2 p_{2n} E_1^2
	\end{gathered}
\]
Для $+$
\[
	\begin{gathered}
	3 p_{1n} E_2^2 - p_{1n} E_1^2 + p_{2n} E_2^2 - 3 p_{2n} E_1^2 + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 + 2 (p_{1n} - p_{2n}) E_1 E_2 =
	\\ = p_{1n} (3 E_2^2 + 2 E_1 E_2 - E_1^2) - p_{2n} (3 E_1^2 + 2 E_1 E_2 - E_2^2) + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 =
	\\ = p_{1n} (E_2 + E_1) (3 E_2 - E_1) - p_{2n} (E_1 + E_2) (3 E_1 - E_2) + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2 =
	\\ = 4 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2) + (p_{1n} - p_{2n}) [(p_{1n} + p_{2n})^2c^2 - (E_1 + E_2)^2]
	\end{gathered}
\]
Для $-$
\[
	\begin{gathered}
	- p_{1n} E_2^2 - p_{1n} E_1^2 + p_{2n} E_2^2 + p_{2n} E_1^2 + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 - 2 (p_{1n} - p_{2n}) E_1 E_2 =
	\\ = - p_{1n} (E_2^2 + 2 E_1 E_2 + E_1^2) + p_{2n} (E_1^2 + 2 E_1 E_2 + E_2^2) + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 =
	\\ = (p_{1n} - p_{2n}) [(p_{1n} + p_{2n})^2c^2 - (E_1 + E_2)^2]
	\end{gathered}
\]
Отсюда следует:
\[
	\left[
	\begin{aligned}
		& x_1 = \frac{p_{1n} - p_{2n}}{2} + \frac{2 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2)/c^2}{(p_{1n} + p_{2n})^2 - (E_1 + E_2)^2/c^2} \\
		& x_2 = \frac{p_{1n} - p_{2n}}{2}
	\end{aligned}
	\right.
\]
Таким образом существуют два решения задачи:
\[
	\left[
	\begin{aligned}
	& p'_{1n} = p_{1n} \\
	& p'_{2n} = p_{2n}
	\end{aligned}
	\right.
	\qquad	
	\left[
	\begin{aligned}
	& p'_{1n} = p_{1n} + \frac{2 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2)/c^2}{(p_{1n} + p_{2n})^2 - (E_1 + E_2)^2/c^2} \\
	& p'_{2n} = p_{2n} - \frac{2 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2)/c^2}{(p_{1n} + p_{2n})^2 - (E_1 + E_2)^2/c^2}
	\end{aligned}
	\right.
\]