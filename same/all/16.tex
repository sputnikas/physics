\section{Упругое столкновение шаров}

\subsection{Нерелятивистский случай}

Пусть сталкиваются два шара и нормаль $\vec{n}$ в точке столкновения известна, поперечных мгновенных сил нет. Здесь всё просто:
\[
	\begin{aligned}
	& p_{1\perp} = p'_{1\perp} \\
	& p_{2\perp} = p'_{2\perp} \\
	& p_{1n} + p_{2n} = p'_{1n} + p'_{2n} \\
	& \frac{p_{1n}^2}{2m_1} + \frac{p_{2n}^2}{2m_2} = \frac{{p'}_{1n}^2}{2m_1} + \frac{{p'}_{2n}^2}{2m_2}
	\end{aligned} 
\]
\[
	\begin{aligned}
	& p_{1n} - p'_{1n} = p'_{2n} - p_{2n} \\
	& \frac{p_{1n}^2 - {p'}_{1n}^2}{m_1} = \frac{{p'}_{2n}^2 - p_{2n}^2}{m_2}
	\end{aligned}
	\Rightarrow
	\begin{aligned}
	& p_{1n} - p'_{1n} = p'_{2n} - p_{2n} \\
	& (p_{1n} - p'_{1n})\left(\frac{p_{1n} + p'_{1n}}{m_1} - \frac{p_{2n} + p'_{2n}}{m_2} \right) = 0
	\end{aligned}
\]
\[
	\frac{p_{1n} + p'_{1n}}{m_1} - \frac{p_{2n} + p'_{2n}}{m_2} = 0
\]
\[
	\frac{m_2}{m_1} (p_{1n} + p'_{1n}) = p_{2n} + p'_{2n}
\]
\[
	\left(1 + \frac{m_2}{m_1} \right) p'_{1n} + \left(\frac{m_2}{m_1} - 1\right) p_{1n} = 2 p_{2n}
\]
\[
	p'_{1n} = 
	\frac{2 m_1}{m_1 + m_2}  p_{2n} + \frac{m_1 - m_2}{m_1 + m_2} p_{1n} = 
	p_{1n} + \frac{2 (m_1 p_{2n} - m_2 p_{1n})}{m_1 + m_2} 
\]
Получаем два варианта ответов:
\[
	\left\{
	\begin{aligned}
	& p'_{1n} = p_{1n} \\
	& p'_{2n} = p_{2n}
	\end{aligned}
	\right.
	\qquad	
	\left\{
	\begin{aligned}
	& p'_{1n} = p_{1n} - \frac{2 (p_{1n} m_2 - p_{2n} m_1)}{m_1 + m_2} \\
	& p'_{2n} = p_{2n} + \frac{2 (p_{1n} m_2 - p_{2n} m_1)}{m_1 + m_2}
	\end{aligned}
	\right.
\]

\subsection{Релятивистский случай}

Пусть сталкиваются два релятивистских шара и нормаль $\vec{n}$ в точке столкновения известна, поперечных мгновенных сил нет. Тогда законы сохранения:
\[
	\begin{aligned}
	& p_{1\perp} = p'_{1\perp} \\
	& p_{2\perp} = p'_{2\perp} \\
	& p_{1n} + p_{2n} = p'_{1n} + p'_{2n} = 2 p \\
	& E_1 + E_2 = E_1' + E_2' = E
	\end{aligned} 
\]
Задача сводится к системе:
\[
	\begin{cases}
		x + y = 0; \\
		\sqrt{(x + p)^2 + a^2} + \sqrt{(y + p)^2 + b^2} = d
	\end{cases}
	\text{ где }
	\begin{cases}
	& x = p'_{1n} - p \\
	& y = p'_{2n} - p \\
	& a^2 = p_{1\perp}^2 + m_1^2 c^2 \\
	& b^2 = p_{2\perp}^2 + m_2^2 c^2 \\
	& d = E/c
	\end{cases}
\]
Или к одному уравнению:
\[
	\sqrt{(x + p)^2 + a^2} + \sqrt{(p - x)^2 + b^2} = d
\]
\[
	d^2 = 2(x^2 + p^2) + a^2 + b^2 + 2\sqrt{(x + p)^2 + a^2}\sqrt{(p - x)^2 + b^2}
\]
\[
	(d^2 - a^2 - b^2  - 2(x^2 + p^2))^2 = 4((x + p)^2 + a^2)((p - x)^2 + b^2)
\]
\[
	(d^2 - a^2 - b^2)^2  - 4(x^2 + p^2)(d^2 - a^2 - b^2) + 4 (x^2 + p^2)^2 = 4(p^2 - x^2)^2 + 4 a^2(p - x)^2 + 4 b^2(p + x)^2 + 4 a^2 b^2
\]
\[
	(d^2 - a^2 - b^2)^2  - 4(x^2 + p^2)(d^2 - a^2 - b^2) + 16 x^2 p^2 =  4 (a^2 + b^2)(p^2 + x^2) + 8 px (b^2 - a^2) + 4 a^2 b^2
\]
\[
	(d^2 - a^2 - b^2)^2  - 4(x^2 + p^2)d^2 + 16 x^2 p^2 =  8 px (b^2 - a^2) + 4 a^2 b^2
\]
\[
	4 x^2 (4 p^2 - d^2) - 8 px (b^2 - a^2) + (d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2 = 0
\]
Это обычное квадратное уравнение. Его дискриминант $D$:
\[
	\begin{gathered}
	D/16 = 4 p^2 (b^2 - a^2)^2 - (4 p^2 - d^2) ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = 4 p^2 [(b^2 - a^2)^2 - (d^2 - a^2 - b^2)^2 + 4 p^2 d^2 + 4 a^2 b^2] + d^2 ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = 4 p^2 [(b^2 + a^2)^2 - (d^2 - a^2 - b^2)^2 + 4 p^2 d^2] + d^2 ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = 4 p^2 [4 p^2 d^2 - d^4 + 2 d^2(a^2 + b^2)] + d^2 ((d^2 - a^2 - b^2)^2 - 4 p^2 d^2 - 4 a^2 b^2) =
	\\ = d^2 [16 p^4 + 8 p^2 (a^2 + b^2) + d^4 - 2 d^2(a^2 + b^2) - 8 p^2 d^2 + (a^2 - b^2)^2] =
	\\ = d^2 [(4p^2 - d^2)^2 + 2(4 p^2 - d^2)(a^2 + b^2) + (a^2 + b^2)^2 - 4 a^2 b^2] =
	\\ = d^2 [(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2]
	\end{gathered}
\]
\[
	x_{1, 2} = \frac{2 p (b^2 - a^2) \pm d\sqrt{(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2}}{2 (4 p^2 - d^2)}
\]
\[
	\begin{gathered}
	4p^2 - d^2 + a^2 + b^2 =
	\\ = (p_{1n} + p_{2n})^2 - \left(\sqrt{p_{1n}^2 + a^2} + \sqrt{p_{2n}^2 + b^2}\right)^2 + a^2 + b^2 =
	\\ = 2 p_{1n} p_{2n} - 2 \sqrt{p_{1n}^2 + a^2} \sqrt{p_{2n}^2 + b^2} = 2 p_{1n} p_{2n} - 2 E_1 E_2/c^2
	\end{gathered}
\]
\[
	\begin{gathered}
	(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2 = 
	\\ = 4 [2 p_{1n}^2 p_{2n}^2 - 2 p_{1n} p_{2n} \sqrt{p_{1n}^2 + a^2} \sqrt{p_{2n}^2 + b^2} + p_{1n}^2 b^2 + p_{2n}^2 a^2] =
	\\ = 4 [ p_{1n}^2 E_2^2 + p_{2n}^2 E_1^2 - 2 p_{1n} p_{2n} E_1 E_2] /c^2 =
	\\ = 4 [ p_{1n} E_2 - p_{2n} E_1]^2/c^2
	\end{gathered}
\]
\[
	b^2 - a^2 = (E_2^2 - E_1^2)/c^2 - p_{2n}^2 + p_{1n}^2
\]
\[
	\begin{gathered}
	c^2(2 p (b^2 - a^2) \pm d\sqrt{(4p^2 - d^2 + a^2 + b^2)^2 - 4 a^2 b^2}) =
	(p_{1n} + p_{2n}) ( (E_2^2 - E_1^2) - p_{2n}^2 c^2 + p_{1n}^2 c^2) \pm 2 (E_1 + E_2)[ p_{1n} E_2 - p_{2n} E_1] =
	\\ = p_{1n} E_2^2 - p_{1n} E_1^2 + p_{2n} E_2^2 - p_{2n} E_1^2 + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2 \pm
	\\ \pm 2 (p_{1n} - p_{2n}) E_1 E_2 \pm  2 p_{1n} E_2^2 \mp 2 p_{2n} E_1^2
	\end{gathered}
\]
Для $+$
\[
	\begin{gathered}
	3 p_{1n} E_2^2 - p_{1n} E_1^2 + p_{2n} E_2^2 - 3 p_{2n} E_1^2 + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 + 2 (p_{1n} - p_{2n}) E_1 E_2 =
	\\ = p_{1n} (3 E_2^2 + 2 E_1 E_2 - E_1^2) - p_{2n} (3 E_1^2 + 2 E_1 E_2 - E_2^2) + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 =
	\\ = p_{1n} (E_2 + E_1) (3 E_2 - E_1) - p_{2n} (E_1 + E_2) (3 E_1 - E_2) + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2 =
	\\ = 4 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2) + (p_{1n} - p_{2n}) [(p_{1n} + p_{2n})^2c^2 - (E_1 + E_2)^2]
	\end{gathered}
\]
Для $-$
\[
	\begin{gathered}
	- p_{1n} E_2^2 - p_{1n} E_1^2 + p_{2n} E_2^2 + p_{2n} E_1^2 + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 - 2 (p_{1n} - p_{2n}) E_1 E_2 =
	\\ = - p_{1n} (E_2^2 + 2 E_1 E_2 + E_1^2) + p_{2n} (E_1^2 + 2 E_1 E_2 + E_2^2) + (p_{1n} - p_{2n})(p_{1n} + p_{2n})^2c^2 =
	\\ = (p_{1n} - p_{2n}) [(p_{1n} + p_{2n})^2c^2 - (E_1 + E_2)^2]
	\end{gathered}
\]
Отсюда следует:
\[
	\left[
	\begin{aligned}
		& x_1 = \frac{p_{1n} - p_{2n}}{2} + \frac{2 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2)/c^2}{(p_{1n} + p_{2n})^2 - (E_1 + E_2)^2/c^2} \\
		& x_2 = \frac{p_{1n} - p_{2n}}{2}
	\end{aligned}
	\right.
\]
Таким образом существуют два решения задачи:
\[
	\left\{
	\begin{aligned}
	& p'_{1n} = p_{1n} \\
	& p'_{2n} = p_{2n}
	\end{aligned}
	\right.
	\qquad	
	\left\{
	\begin{aligned}
	& p'_{1n} = p_{1n} - \frac{2 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2)/c^2}{(E_1 + E_2)^2/c^2 - (p_{1n} + p_{2n})^2} \\
	& p'_{2n} = p_{2n} + \frac{2 (p_{1n} E_2 - p_{2n} E_1) (E_1 + E_2)/c^2}{(E_1 + E_2)^2/c^2 - (p_{1n} + p_{2n})^2}
	\end{aligned}
	\right.
\]

\subsection{Условия столкновения}

Допустим, что 2 шара радиусов $R_1$ и $R_2$ движутся прямолинейно и равномерно со скоростями $\vec{v}_1$ и $\vec{v}_2$, координаты центров в момент времени $t_p$ равны $\vec{r}_1$ и $\vec{r}_2$ соответственно. В момент столкновения:
\[
	|\vec{r}_1  - \vec{r}_2 + (\vec{v}_1 - \vec{v}_2) (t - t_p)| = R_1 + R_2
\] 
Обозначим $\vec{r}_{12} = \vec{r}_1  - \vec{r}_2$, $\vec{v}_{12} = \vec{v}_1 - \vec{v}_2$, $\tau = t - t_p$, $R = R_1 + R_2$.
\[
	r_{12}^2 + v_{12}^2 \tau^2 + 2 \tau (\vec{v}_{12}\cdot\vec{r}_{12}) = R^2
\]
\[
	r_{12}^2 + v_{12}^2 \tau^2 + 2 \tau v_{12} r_{12} \cos \theta  = R^2
\]
\[
	\begin{gathered}
	\tau_{1,2} = - \frac{r_{12} \cos \theta \mp \sqrt{r_{12}^2 \cos^2 \theta - r_{12}^2  + R^2}}{v_{12}} =
	\\ = - \frac{r_{12} \cos \theta \mp \sqrt{R^2 - r_{12}^2 \sin^2 \theta}}{v_{12}} =
	\\ = r_{12} \frac{ - \cos \theta \pm \sqrt{R^2/r_{12}^2 - \sin^2 \theta}}{v_{12}}
	\end{gathered} 
\]
Но $\tau > 0$, $R < r_{12}$, если выбрать знак +:
\[
	\sqrt{R^2/r_{12}^2 - \sin^2 \theta} > \cos \theta
\]
Если $\cos \theta > 0$:
\[
	R^2/r_{12}^2 > 1
\]
Поэтому $\cos \theta < 0$. Если выбрать знак - также $\cos \theta < 0$:
\[
	- \cos \theta > \sqrt{R^2/r_{12}^2 - \sin^2 \theta}
\]
\[
	1 > R^2/r_{12}^2
\]
В результате получилось два момента столкновения, но только один из них соответствует действительности: тот который был раньше. Как следует из выше сказанного: 
\[
	\tau = \frac{ - \cos \theta - \sqrt{R^2/r_{12}^2 - \sin^2 \theta}}{v_{12}} r_{12} 
\]
Необходимые и достаточные условия столкновения:
\[
	\cos \theta < 0, \quad 1 > R^2/r_{12}^2 > \sin^2 \theta 
\]
Нормаль столкновения:
\[
	\vec{n} = \frac{\vec{r}_{12} + \vec{v}_{12} \tau}{|\vec{r}_{12} + \vec{v}_{12} \tau|}
\]